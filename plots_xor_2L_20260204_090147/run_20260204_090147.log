
================================================================================
XOR Test Suite for Network_2L (TwoStageIsingNetwork)
================================================================================
Device: cuda
Batch size: 16
Epochs: 200
Model size: -1
Learning rates: gamma=0.001, lambda=0.001, offset=0.001, classical=0.001
Annealing: beta=[1, 10], reads=1, sweeps=1000
Generating 1D XOR data...
Total samples: 400, Features: 1
Class distribution: [200 200]
Train set: 320 samples - Class distribution: [160 160] ([50. 50.]%)
Test set: 80 samples - Class distribution: [40 40] ([50. 50.]%)

============================================================
Training Network_2L on 1D XOR
============================================================
Model size: 20
Model created with 4056 parameters

Starting training...
Epoch 10/200 | Loss: 0.3628 | Val Acc: 0.9750
Epoch 20/200 | Loss: 0.1814 | Val Acc: 0.9625
Epoch 30/200 | Loss: 0.1226 | Val Acc: 0.9750
Epoch 40/200 | Loss: 0.0617 | Val Acc: 0.9875
Epoch 50/200 | Loss: 0.0698 | Val Acc: 0.9750
Epoch 60/200 | Loss: 0.0666 | Val Acc: 0.9875
Epoch 70/200 | Loss: 0.0614 | Val Acc: 0.9750
Epoch 80/200 | Loss: 0.0508 | Val Acc: 0.9750
Epoch 90/200 | Loss: 0.0474 | Val Acc: 0.9750
Epoch 100/200 | Loss: 0.0521 | Val Acc: 0.9500
Epoch 110/200 | Loss: 0.0442 | Val Acc: 0.9750
Epoch 120/200 | Loss: 0.0427 | Val Acc: 0.9750
Epoch 130/200 | Loss: 0.0389 | Val Acc: 0.9875
Epoch 140/200 | Loss: 0.0456 | Val Acc: 0.9875
Epoch 150/200 | Loss: 0.0372 | Val Acc: 0.9875
Epoch 160/200 | Loss: 0.0564 | Val Acc: 0.9750
Epoch 170/200 | Loss: 0.0318 | Val Acc: 1.0000
Epoch 180/200 | Loss: 0.0435 | Val Acc: 0.9750
Epoch 190/200 | Loss: 0.0314 | Val Acc: 1.0000
Epoch 200/200 | Loss: 0.0370 | Val Acc: 1.0000

============================================================
Final Evaluation
============================================================
Final Test Accuracy: 1.0000

Classification Report:
              precision    recall  f1-score   support

     Class 0       1.00      1.00      1.00        40
     Class 1       1.00      1.00      1.00        40

    accuracy                           1.00        80
   macro avg       1.00      1.00      1.00        80
weighted avg       1.00      1.00      1.00        80


Confusion Matrix:
[[40  0]
 [ 0 40]]

1D XOR completed with accuracy: 1.0000

Generating 2D XOR data...
Total samples: 800, Features: 2
Class distribution: [400 400]
Train set: 640 samples - Class distribution: [320 320] ([50. 50.]%)
Test set: 160 samples - Class distribution: [80 80] ([50. 50.]%)

============================================================
Training Network_2L on 2D XOR
============================================================
Model size: 20
Model created with 4056 parameters

Starting training...
Epoch 10/200 | Loss: 0.6795 | Val Acc: 0.6000
Epoch 20/200 | Loss: 0.6739 | Val Acc: 0.5062
Epoch 30/200 | Loss: 0.6693 | Val Acc: 0.5750
Epoch 40/200 | Loss: 0.6679 | Val Acc: 0.5875
Epoch 50/200 | Loss: 0.6632 | Val Acc: 0.5125
Epoch 60/200 | Loss: 0.6592 | Val Acc: 0.5875
Epoch 70/200 | Loss: 0.6546 | Val Acc: 0.5813
Epoch 80/200 | Loss: 0.6596 | Val Acc: 0.5687
Epoch 90/200 | Loss: 0.6488 | Val Acc: 0.5813
Epoch 100/200 | Loss: 0.6474 | Val Acc: 0.5938
Epoch 110/200 | Loss: 0.6480 | Val Acc: 0.5813
Epoch 120/200 | Loss: 0.6456 | Val Acc: 0.5687
Epoch 130/200 | Loss: 0.6436 | Val Acc: 0.5813
Epoch 140/200 | Loss: 0.6411 | Val Acc: 0.5813
Epoch 150/200 | Loss: 0.6426 | Val Acc: 0.5938
Epoch 160/200 | Loss: 0.6421 | Val Acc: 0.5813
Epoch 170/200 | Loss: 0.6436 | Val Acc: 0.5875
Epoch 180/200 | Loss: 0.6439 | Val Acc: 0.5875
Epoch 190/200 | Loss: 0.6412 | Val Acc: 0.5813
Epoch 200/200 | Loss: 0.6407 | Val Acc: 0.6000

============================================================
Final Evaluation
============================================================
Final Test Accuracy: 0.5875

Classification Report:
              precision    recall  f1-score   support

     Class 0       0.58      0.61      0.60        80
     Class 1       0.59      0.56      0.58        80

    accuracy                           0.59       160
   macro avg       0.59      0.59      0.59       160
weighted avg       0.59      0.59      0.59       160


Confusion Matrix:
[[49 31]
 [35 45]]

2D XOR completed with accuracy: 0.5875

Generating 3D XOR data...
Total samples: 1600, Features: 3
Class distribution: [800 800]
Train set: 1280 samples - Class distribution: [640 640] ([50. 50.]%)
Test set: 320 samples - Class distribution: [160 160] ([50. 50.]%)

============================================================
Training Network_2L on 3D XOR
============================================================
Model size: 20
Model created with 4056 parameters

Starting training...
Epoch 10/200 | Loss: 0.6944 | Val Acc: 0.4969
Epoch 20/200 | Loss: 0.6937 | Val Acc: 0.5000
Epoch 30/200 | Loss: 0.6939 | Val Acc: 0.5000
Epoch 40/200 | Loss: 0.6941 | Val Acc: 0.5000
Epoch 50/200 | Loss: 0.6935 | Val Acc: 0.5094
Epoch 60/200 | Loss: 0.6939 | Val Acc: 0.5094
Epoch 70/200 | Loss: 0.6939 | Val Acc: 0.5000
Epoch 80/200 | Loss: 0.6941 | Val Acc: 0.5188
Epoch 90/200 | Loss: 0.6944 | Val Acc: 0.5000
Epoch 100/200 | Loss: 0.6940 | Val Acc: 0.5031
Epoch 110/200 | Loss: 0.6932 | Val Acc: 0.5031
Epoch 120/200 | Loss: 0.6935 | Val Acc: 0.5062
Epoch 130/200 | Loss: 0.6934 | Val Acc: 0.5125
Epoch 140/200 | Loss: 0.6933 | Val Acc: 0.5156
Epoch 150/200 | Loss: 0.6936 | Val Acc: 0.4938
Epoch 160/200 | Loss: 0.6934 | Val Acc: 0.5000
Epoch 170/200 | Loss: 0.6936 | Val Acc: 0.4969
Epoch 180/200 | Loss: 0.6935 | Val Acc: 0.5062
Epoch 190/200 | Loss: 0.6934 | Val Acc: 0.5031
Epoch 200/200 | Loss: 0.6934 | Val Acc: 0.5000

============================================================
Final Evaluation
============================================================
Final Test Accuracy: 0.5125

Classification Report:
              precision    recall  f1-score   support

     Class 0       0.51      0.99      0.67       160
     Class 1       0.75      0.04      0.07       160

    accuracy                           0.51       320
   macro avg       0.63      0.51      0.37       320
weighted avg       0.63      0.51      0.37       320


Confusion Matrix:
[[158   2]
 [154   6]]

3D XOR completed with accuracy: 0.5125

Generating 4D XOR data...
Total samples: 3200, Features: 4
Class distribution: [1600 1600]
Train set: 2560 samples - Class distribution: [1280 1280] ([50. 50.]%)
Test set: 640 samples - Class distribution: [320 320] ([50. 50.]%)

============================================================
Training Network_2L on 4D XOR
============================================================
Model size: 20
Model created with 4056 parameters

Starting training...
Epoch 10/200 | Loss: 0.6941 | Val Acc: 0.5344
Epoch 20/200 | Loss: 0.6936 | Val Acc: 0.4781
Epoch 30/200 | Loss: 0.6937 | Val Acc: 0.5109
Epoch 40/200 | Loss: 0.6941 | Val Acc: 0.4891
Epoch 50/200 | Loss: 0.6936 | Val Acc: 0.5188
Epoch 60/200 | Loss: 0.6938 | Val Acc: 0.4969
Epoch 70/200 | Loss: 0.6931 | Val Acc: 0.4906
Epoch 80/200 | Loss: 0.6932 | Val Acc: 0.4922
Epoch 90/200 | Loss: 0.6931 | Val Acc: 0.5125
Epoch 100/200 | Loss: 0.6931 | Val Acc: 0.5000
Epoch 110/200 | Loss: 0.6932 | Val Acc: 0.4875
