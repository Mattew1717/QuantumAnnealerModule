
================================================================================
XOR Test Suite for Network_2L (TwoStageIsingNetwork)
================================================================================
Device: cuda
Batch size: 16
Epochs: 200
Model size: -1
Learning rates: gamma=0.001, lambda=0.001, offset=0.001, classical=0.001
Annealing: beta=[1, 10], reads=1, sweeps=1000
Generating 1D XOR data...
Total samples: 400, Features: 1
Class distribution: [200 200]
Train set: 320 samples - Class distribution: [160 160] ([50. 50.]%)
Test set: 80 samples - Class distribution: [40 40] ([50. 50.]%)

============================================================
Training Network_2L on 1D XOR
============================================================
Model size: 20
Model created with 4056 parameters

Starting training...
Epoch 10/200 | Loss: 0.2272 | Val Acc: 1.0000
Epoch 20/200 | Loss: 0.1346 | Val Acc: 1.0000
Epoch 30/200 | Loss: 0.1045 | Val Acc: 0.9875
Epoch 40/200 | Loss: 0.0897 | Val Acc: 1.0000
Epoch 50/200 | Loss: 0.0818 | Val Acc: 0.9500
Epoch 60/200 | Loss: 0.0664 | Val Acc: 0.9750
Epoch 70/200 | Loss: 0.0678 | Val Acc: 0.9875
Epoch 80/200 | Loss: 0.0588 | Val Acc: 0.9750
Epoch 90/200 | Loss: 0.0581 | Val Acc: 0.9875
Epoch 100/200 | Loss: 0.0525 | Val Acc: 0.9625
Epoch 110/200 | Loss: 0.0426 | Val Acc: 1.0000
Epoch 120/200 | Loss: 0.0381 | Val Acc: 0.9875
Epoch 130/200 | Loss: 0.0433 | Val Acc: 0.9875
Epoch 140/200 | Loss: 0.0354 | Val Acc: 1.0000
Epoch 150/200 | Loss: 0.0351 | Val Acc: 1.0000
Epoch 160/200 | Loss: 0.0386 | Val Acc: 0.9875
Epoch 170/200 | Loss: 0.0342 | Val Acc: 1.0000
Epoch 180/200 | Loss: 0.0299 | Val Acc: 0.9875
Epoch 190/200 | Loss: 0.0361 | Val Acc: 0.9875
Epoch 200/200 | Loss: 0.0368 | Val Acc: 0.9875

============================================================
Final Evaluation
============================================================
Final Test Accuracy: 0.9875

Classification Report:
              precision    recall  f1-score   support

     Class 0       1.00      0.97      0.99        40
     Class 1       0.98      1.00      0.99        40

    accuracy                           0.99        80
   macro avg       0.99      0.99      0.99        80
weighted avg       0.99      0.99      0.99        80


Confusion Matrix:
[[39  1]
 [ 0 40]]

1D XOR completed with accuracy: 0.9875

Generating 2D XOR data...
Total samples: 800, Features: 2
Class distribution: [400 400]
Train set: 640 samples - Class distribution: [320 320] ([50. 50.]%)
Test set: 160 samples - Class distribution: [80 80] ([50. 50.]%)

============================================================
Training Network_2L on 2D XOR
============================================================
Model size: 20
Model created with 4056 parameters

Starting training...
Epoch 10/200 | Loss: 0.5665 | Val Acc: 0.8812
Epoch 20/200 | Loss: 0.4627 | Val Acc: 0.8875
Epoch 30/200 | Loss: 0.3781 | Val Acc: 0.9062
Epoch 40/200 | Loss: 0.3286 | Val Acc: 0.9000
Epoch 50/200 | Loss: 0.2960 | Val Acc: 0.9062
Epoch 60/200 | Loss: 0.2729 | Val Acc: 0.9187
Epoch 70/200 | Loss: 0.2508 | Val Acc: 0.9125
Epoch 80/200 | Loss: 0.2344 | Val Acc: 0.9250
Epoch 90/200 | Loss: 0.2193 | Val Acc: 0.9062
Epoch 100/200 | Loss: 0.2119 | Val Acc: 0.9313
Epoch 110/200 | Loss: 0.2056 | Val Acc: 0.9187
Epoch 120/200 | Loss: 0.1973 | Val Acc: 0.9500
Epoch 130/200 | Loss: 0.1908 | Val Acc: 0.9500
Epoch 140/200 | Loss: 0.1833 | Val Acc: 0.9437
Epoch 150/200 | Loss: 0.1874 | Val Acc: 0.9187
Epoch 160/200 | Loss: 0.1851 | Val Acc: 0.9375
Epoch 170/200 | Loss: 0.1758 | Val Acc: 0.9437
Epoch 180/200 | Loss: 0.1660 | Val Acc: 0.9563
Epoch 190/200 | Loss: 0.1613 | Val Acc: 0.9437
Epoch 200/200 | Loss: 0.1640 | Val Acc: 0.9437

============================================================
Final Evaluation
============================================================
Final Test Accuracy: 0.9375

Classification Report:
              precision    recall  f1-score   support

     Class 0       0.95      0.93      0.94        80
     Class 1       0.93      0.95      0.94        80

    accuracy                           0.94       160
   macro avg       0.94      0.94      0.94       160
weighted avg       0.94      0.94      0.94       160


Confusion Matrix:
[[74  6]
 [ 4 76]]

2D XOR completed with accuracy: 0.9375

Generating 3D XOR data...
Total samples: 1600, Features: 3
Class distribution: [800 800]
Train set: 1280 samples - Class distribution: [640 640] ([50. 50.]%)
Test set: 320 samples - Class distribution: [160 160] ([50. 50.]%)

============================================================
Training Network_2L on 3D XOR
============================================================
Model size: 20
Model created with 4056 parameters

Starting training...
Epoch 10/200 | Loss: 0.6741 | Val Acc: 0.6125
Epoch 20/200 | Loss: 0.6444 | Val Acc: 0.5969
Epoch 30/200 | Loss: 0.6092 | Val Acc: 0.6906
Epoch 40/200 | Loss: 0.5680 | Val Acc: 0.7063
Epoch 50/200 | Loss: 0.5339 | Val Acc: 0.7406
Epoch 60/200 | Loss: 0.4995 | Val Acc: 0.7750
Epoch 70/200 | Loss: 0.4750 | Val Acc: 0.7875
Epoch 80/200 | Loss: 0.4469 | Val Acc: 0.7937
Epoch 90/200 | Loss: 0.4282 | Val Acc: 0.8063
Epoch 100/200 | Loss: 0.4281 | Val Acc: 0.7750
Epoch 110/200 | Loss: 0.4302 | Val Acc: 0.8000
Epoch 120/200 | Loss: 0.4351 | Val Acc: 0.7750
Epoch 130/200 | Loss: 0.4532 | Val Acc: 0.7969
Epoch 140/200 | Loss: 0.4448 | Val Acc: 0.8031
Epoch 150/200 | Loss: 0.5017 | Val Acc: 0.7281
Epoch 160/200 | Loss: 0.4814 | Val Acc: 0.7156
Epoch 170/200 | Loss: 0.5133 | Val Acc: 0.7156
Epoch 180/200 | Loss: 0.5049 | Val Acc: 0.7250
Epoch 190/200 | Loss: 0.5262 | Val Acc: 0.7281
Epoch 200/200 | Loss: 0.5666 | Val Acc: 0.7250

============================================================
Final Evaluation
============================================================
Final Test Accuracy: 0.6781

Classification Report:
              precision    recall  f1-score   support

     Class 0       0.67      0.71      0.69       160
     Class 1       0.69      0.64      0.67       160

    accuracy                           0.68       320
   macro avg       0.68      0.68      0.68       320
weighted avg       0.68      0.68      0.68       320


Confusion Matrix:
[[114  46]
 [ 57 103]]

3D XOR completed with accuracy: 0.6781

Generating 4D XOR data...
Total samples: 3200, Features: 4
Class distribution: [1600 1600]
Train set: 2560 samples - Class distribution: [1280 1280] ([50. 50.]%)
Test set: 640 samples - Class distribution: [320 320] ([50. 50.]%)

============================================================
Training Network_2L on 4D XOR
============================================================
Model size: 20
Model created with 4056 parameters

Starting training...
Epoch 10/200 | Loss: 0.6852 | Val Acc: 0.5437
Epoch 20/200 | Loss: 0.6574 | Val Acc: 0.7141
Epoch 30/200 | Loss: 0.6038 | Val Acc: 0.7578
Epoch 40/200 | Loss: 0.5344 | Val Acc: 0.7312
Epoch 50/200 | Loss: 0.4766 | Val Acc: 0.8422
Epoch 60/200 | Loss: 0.4332 | Val Acc: 0.8797
